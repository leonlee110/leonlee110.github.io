---
title: Go语言快速入门（一）
layout: page
categories: Go
tags: [Go, Kubernets]
---

Go是一门比较新的语言，是由一群牛人在Google推出的，这些牛人大多来自贝尔实验室的Plan 9操作系统项目和Limbo语言设计项目，因此大多认为Go的前身就是Limbo。同时这些牛人中有C语言的设计者Ken Thompson，因此Go的设计里面也包含了一些C的思想或者去解决一些C语言上效率的问题。

它的主要语言特性有：
- 自动的垃圾回收，针对内存泄漏和野指针
- 原生支持一些复杂的类型，字典、数组切片（动态数组）
- 匿名函数和闭包
- 有限的类型和借口
- 多函数返回值
- 统一的错误处理机制，defer、panic、recove
- 原生支持并发编程
- 反射
- 语言交互性好

果然是一门“现代”语言，一门“更强的C语言”。

这个系列的几篇博客，主要就是记录下Go的基础要点，以及一些学习过程中的思考，也希望对有缘的人有所帮助。
- 基础，就是和其他语言有什么不同，主要是C和C++
- 并行编程，这是Go语言的优势所在
- 高级特性，一些特性或者装逼情况下可用

## Go程序的基本结构
开始一门语言的学习，基本上先要了解这门语言的程序是怎样组织起来的，代码的基础组成是怎样的，怎样能让一个程序运行起来。Go在程序结构上就体现出了它的先进性。
如下就是一个非常简单的Go程序：
```
package main

import "fmt"
import "os"
import "strings"

func f(x int) int {
    if x == 0 {
        x = 5
    } else {
        x = 7
    }

    return x
}

func main() {
    fmt.Println(os.Args[0])

    for index, arg := range os.Args[1:] {
        fmt.Println(index, ":", arg)
    }

    fmt.Println(strings.Join(os.Args[1:], " "))

    fmt.Println(f(3))
    fmt.Println(f(5))
}
```
- package，指定源文件的包名，包名可以理解成一个针对文件的namespace，一个对应于python中文件名的功能，总之用来表征一个文件中符号的所属
- import，需要引入其他包的变量或者函数
- func，定义函数，这里和其他一些常见函数最大的区别就是，返回值在最后面；同时"{"符号必须和func同行
- if，条件判断语句，比较大的区别就是判断条件没有用"("包围起来，同func，“{”必须与if同行
- for， 循环语句，在这个例子中直接调用range遍历一个数组，并将相关变量赋值，也有我们常见的那种形式，后续可能会提到
- fmt，调用Println打印信息，每个函数总有相应的printf

除了上面的一些关键字外，还有个特点，支持多重赋值，for循环的index，arg两变量就是在一条语句中赋值的，这个特点也非常使用。

实现很多很多这种格式的代码文件，然后通过import关联起来，这样就组成了我们的Go项目了。
```
<calcproj> ├─<src>
              ├─<calc>
                ├─calc.go
              ├─<simplemath>
                ├─add.go
                ├─add_test.go
                ├─sqrt.go
                ├─sqrt_test.go
            |─<bin>
```
将calcproj目录加到环境变量GOPATH中，export GOPATH=$GOPATH:xxx:xxx:calcproj，然后运行go build calcproj即可获得相关的执行文件了。

编译是不是也非常简单？工程效率太高了，不用管理复杂的makefile了。

## 变量
- 和前面提到的函数一样，Go变量最大的不同就是变量类型是在末尾：```var i int ```。
- 函数初始化，可以有很多方法：
  * var v1 int = 1
  * var v2 = 3
  * v3 := 5

  第三种方法最简单，这个该说是真现代，还是真懒呢？但是用多了，可能就会潜移默化吧。第二种和第三种编译器都会去根据赋的值推到出变量类型。但需要铭记的是Go是一个强类型的静态语言，即使这个特定和一些动态语言类型，它也是编译器静态编译出确切的类型的。
- 前面也提到，Go支持多种赋值，比如i, j = j, i，通过多重赋值非常简单的实现了两个变量交换的功能。
- 后面会介绍，函数返回值支持多变量返回。同时变量支持匿名变量，这样对于函数返回值中不感兴趣的可以使用匿名变量"\_"，```_, a, _ = f()```假设f返回3个值，a获得第二个值
- 有个特殊的常量iota，在每一个const出现时，置为0，在下一次const出现前，每出现依次iota，则加1。另外如果前后const表达式是一致的，可以省略后面的iota。通过这个功能可以很容易实现枚举。

```
const (
    c0 = iota     // c0 = 0
    c1 = iota     // c1 = 1
    c2 = iota     // c2 = 2
)

const (
    c3 = 1 << iota     // c3 = 1
    c4 = 1 << iota     // c4 = 2
)

const (
    c5 = 1 << iota     // c5 = 1
    c6            // c6 = 2
    c7            // c7 = 4
)
```
在一些特殊场景下，用起来还是非常方便。

## 类型
除了常见类型，支持一些常见的其他语言需要用库来实现的类型。
- 布尔类型，Go语言的bool类型比较特殊的地方在于，bool类型不支持其他类型赋值，不支持自动或者强制类型转换，也就是说bool类型就是ture或false
- 复数，支持常见复数表示初始化，或者通过complex函数，并且可以通过real函数获得实部，imag函数获得虚部
```
value1 := 3.2 + 12i
value2 := complex(3.2, 12)
```
-
