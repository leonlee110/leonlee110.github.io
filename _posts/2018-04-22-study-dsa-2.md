---
title: Domain Specific Architecture：TPU
layout: page
categories: HardwareArchitecture
tags: [dsa, cpu]
---

## 1. 简介
- 用于Inference
- 有65536（256*256）8bit ALU Matrix Multiply Unit
- 大内存

## 2. 架构
先摆出基本架构图：
![tpuarch](/assets/dsa/tpu_arch.png){:class="img-responsive center-block" width="600px"}

几个主要组成部分是：
- Matrix Multiply Unit：执行8bit的矩阵乘加
- Accumulators：存储矩阵乘加输出的中间结果
- Activation：执行非线性激活函数
- Weight FIFO：从外部的Weight Memory中缓存权重信息
- Unified Buffer：从主机内存中读取中间结果

## 3. 主要操作
结合架构中的主要部件，主要有如下指令操作：
- Read_Host_Memory：从主机读取输入信息到Unified Buffer中
- Read_Weight：从Weight Memory中读取权重信息到Weight FIFO中
- MatrixMultiply/Convole：将Unified Buffer中的信息与Weight FIFO中的信息执行指定操作，结果存储到Accumulators中
- Activate：执行非线性激活函数，并将结果写回到Unified Buffer中
- Write_Host_Memory：将结果写回到主机内存中

TPU中的指令有12 bytes，其中3个bytes是Unified Buffer地址，2个byte是Acumulators地址，4个byte是length，剩下的是opcode和flags。
